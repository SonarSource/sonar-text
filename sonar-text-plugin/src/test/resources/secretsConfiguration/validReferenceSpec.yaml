provider:  
  metadata:
      name: provider name
      category: Cloud provider
      references:
        - description: Reference 1
          link: https://docs.aws.amazon.com/IAM/...
          type: Standards
        - description: Reference 2
          link: https://docs.aws.amazon.com/IAM/...
          type: Documentation
        - description: Reference 3
          link: https://docs.aws.amazon.com/IAM/...
          type: Conference Presentations
        - description: Reference 4
          link: https://docs.aws.amazon.com/IAM/...
          type: Articles & blog posts
      message: provider message
      fix: provider fix
      impact: provider impact
  detection:
    pre:
      include:
        paths:
          - "*.aws/config"
          - ".env"
        ext:
          - ".config"
        content:
          - "amazonaws.com"
          - "aws"
      reject:
        paths:
          - "amazonaws.com"
          - "aws"
    matching:
      matchEither:
        - patternBefore: "AKIA[A-Z0-9]{16}"
        - pattern: "[0-9a-z\\/+]{40}"
        - matchEach:
            - patternAfter: "pattern-after"
            - patternAround: "pattern-around"
        - matchEither:
            - patternNot: "pattern-not"
            - patternAround: "pattern-around"
    post:
      statisticalFilter:
        threshold: 5
        inputString: "Test String"
      patternNot: EXAMPLEKEY
      heuristicFilter:
        heuristics:
          - "exampleHeuristics"
        inputString: "Test String"
  rules:
    - id: aws-access-key
      metadata:
        name: rule name
        defaultProfile: false
        charset: "[0-9a-z\\/+]"
        message: rule message
        impact: rule impact
        fix: rule fix
        references:
          - description: rule reference
            link: https://docs.aws.amazon.com/IAM/...
            type: Standards
      detection:
        pre:
          include:
            paths:
              - "*.aws/config"
              - ".env"
            ext:
              - ".config"
            content:
              - "amazonaws.com"
              - "aws"
          reject:
            paths:
              - "amazonaws.com"
              - "aws"
        matching:
          matchEither:
            - patternBefore: "AKIA[A-Z0-9]{16}"
            - pattern: "[0-9a-z\\/+]{40}"
            - matchEach:
                - patternAfter: "pattern-after"
                - patternAround: "pattern-around"
            - matchEither:
                - patternNot: "pattern-not"
                - patternAround: "pattern-around"
        post:
          statisticalFilter:
            threshold: 5
            inputString: "Test String"
          patternNot: EXAMPLEKEY
          heuristicFilter:
            heuristics:
              - "exampleHeuristics"
            inputString: "Test String"
      examples:
        - text: >
            example
            text
          containsSecret: true
          match: LGYIh8rDziCXCgDCUbJq1h7CKwNqnpA1il4MXL+y
