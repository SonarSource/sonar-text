provider:
  metadata:
    name: Mailgun
    category: Messaging System
    message: Make sure this Mailgun API key gets revoked, changed, and removed from the code.
  detection:
    pre:
      include:
        content:
          - mailgun
    post:
      # Avoid matching values found on SourceGraph that look like dummy passwords or insertions like:
      # - key-00000000000000000000000000000000
      patternNot: 
        - "(?i)(\\w)\\1{6,}"
  rules:
    - rspecKey: S6723
      id: mailgun-primary-key
      metadata:
        name: Mailgun Primary Key
      examples:
        - text: |
            name="Mailgun"
            authorization-key="key-9143771821d4442f2cb934f8d2fe4e05"
          containsSecret: true
          match: key-9143771821d4442f2cb934f8d2fe4e05
        - text: |
            mailgunAPIKey    = "key-00000000000000000000000000000000"
          containsSecret: false
      detection:
        matching:
          pattern: "(?i)\\b(key-[a-f0-9]{32})\\b"
