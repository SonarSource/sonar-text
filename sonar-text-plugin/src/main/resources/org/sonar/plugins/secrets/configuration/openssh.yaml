provider:
  metadata:
    name: OpenSSH
    category: Authentication
    message: Make sure this SSH private key gets revoked, changed, and removed from the code.
  detection:
    pre:
      include:
        content:
          - "PRIVATE KEY-----"

  rules:
    - id: ssh-private-key
      metadata:
        name: SSH private keys should not be disclosed
      detection:
        matching:
          pattern: -----BEGIN OPENSSH PRIVATE KEY------"
          context:
            match-each:
              - patternAfter: "b3BlbnNzaC1rZXktdj" 
              - patternAfter: -----END OPENSSH PRIVATE KEY-----"
      examples:
        - text: >
            -----BEGIN OPENSSH PRIVATE KEY-----
            b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
            QyNTUxOQAAACDktj2RM1D2wRTQ0H+YZsFqnAuZrqBNEB4PpJ5xm73nWwAAAJgJVPFECVTx
            RAAAAAtzc2gtZWQyNTUxOQAAACDktj2RM1D2wRTQ0H+YZsFqnAuZrqBNEB4PpJ5xm73nWw
            AAAECQ8Nzp6a1ZJgS3SWh2pMxe90W9tZVDZ+MZT35GjCJK2uS2PZEzUPbBFNDQf5hmwWqc
            C5muoE0QHg+knnGbvedbAAAAFGdhZXRhbmZlcnJ5QFBDLUwwMDc3AQ==
            -----END OPENSSH PRIVATE KEY-----
          containsSecret: true
          match: -----BEGIN OPENSSH PRIVATE KEY-----
