provider:
  metadata:
    name: Generic public key cryptography
    category: Cryptography
    message: Make sure this private key gets revoked, changed, and removed from the code.
  rules:
    - id: rsa-private-key
      metadata:
        name: RSA private keys should not be disclosed
      detection:
        matching:
          pattern: "\\b-----BEGIN RSA PRIVATE KEY-----\\b"
          context:
            patternAfter: "\\b-----END RSA PRIVATE KEY-----\\b"
      examples:
        - text: >
            -----BEGIN RSA PRIVATE KEY-----
            MIIBOwIBAAJBAK5t3sjyTuxwetc6k0K/wNGgX975WQpyXu4+QTpyYZgCiHGQC+qq
            buftxyNhS5+tOpP6p/F7nIJMluWedxGDD90CAwEAAQJBAKJtpZwyJ9R9Gab64M6z
            iXarhRs5zvSvdD8esdcfVEob5qwVZWunzuwptGSekG0STtozgy3qHn5w3BBRr6Dn
            P4ECIQDmlpWHikNGRcTbzD9rSCzkvtWJAFasdhXQ8ArHjXsUOQIhAMGm6ZjtOboG
            ckaK0QvvhqlOkOeQjtAH2qUiXrbFMIDFAiAUpzwxbbLk4m7leP/dLhPHUUhzAvLA
            c7s0gauVgBicEQIhAKQP6ApCuMxsl7ZB9zd4d4rK4CL/Kq7+aHPM+Zc42o3NAiAV
            8bZ9UdYLXr4xuCJ1ktyr/8lCy/IJ6qEPYQyBLfhuVQ==
            -----END RSA PRIVATE KEY-----
          containsSecret: true
    - id: rsa-private-key-encrypted
      metadata:
        name: RSA encrypted private keys should not be disclosed
      detection:
        matching:
          pattern: "\\b-----BEGIN RSA PRIVATE KEY-----\\b"
          context:
            matchEach:
              - patternAfter: "\\bProc-Type: 4,ENCRYPTED\\b"
              - patternAfter: "\\b-----END RSA PRIVATE KEY-----\\b"
      examples:
        - text: >
            -----BEGIN RSA PRIVATE KEY-----
            MIIBOwIBAAJBAK5t3sjyTuxwetc6k0K/wNGgX975WQpyXu4+QTpyYZgCiHGQC+qq
            buftxyNhS5+tOpP6p/F7nIJMluWedxGDD90CAwEAAQJBAKJtpZwyJ9R9Gab64M6z
            iXarhRs5zvSvdD8esdcfVEob5qwVZWunzuwptGSekG0STtozgy3qHn5w3BBRr6Dn
            P4ECIQDmlpWHikNGRcTbzD9rSCzkvtWJAFasdhXQ8ArHjXsUOQIhAMGm6ZjtOboG
            ckaK0QvvhqlOkOeQjtAH2qUiXrbFMIDFAiAUpzwxbbLk4m7leP/dLhPHUUhzAvLA
            c7s0gauVgBicEQIhAKQP6ApCuMxsl7ZB9zd4d4rK4CL/Kq7+aHPM+Zc42o3NAiAV
            8bZ9UdYLXr4xuCJ1ktyr/8lCy/IJ6qEPYQyBLfhuVQ==
            -----END RSA PRIVATE KEY-----
          containsSecret: true
