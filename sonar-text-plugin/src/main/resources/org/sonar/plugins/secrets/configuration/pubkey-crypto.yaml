provider:
  metadata:
    name: Generic public key cryptography
    category: Cryptography
    message: Make sure this private key gets revoked, changed, and removed from the code.
  rules:
    - id: rsa-private-key
      metadata:
        name: RSA private keys should not be disclosed
      detection:
        matching:
          pattern: "\\b-----BEGIN RSA PRIVATE KEY-----\\b"
          context:
            patternAfter: "\\b-----END RSA PRIVATE KEY-----\\b"
      examples:
        - text: >
            -----BEGIN RSA PRIVATE KEY-----
            MIIBOwIBAAJBAK5t3sjyTuxwetc6k0K/wNGgX975WQpyXu4+QTpyYZgCiHGQC+qq
            buftxyNhS5+tOpP6p/F7nIJMluWedxGDD90CAwEAAQJBAKJtpZwyJ9R9Gab64M6z
            iXarhRs5zvSvdD8esdcfVEob5qwVZWunzuwptGSekG0STtozgy3qHn5w3BBRr6Dn
            P4ECIQDmlpWHikNGRcTbzD9rSCzkvtWJAFasdhXQ8ArHjXsUOQIhAMGm6ZjtOboG
            ckaK0QvvhqlOkOeQjtAH2qUiXrbFMIDFAiAUpzwxbbLk4m7leP/dLhPHUUhzAvLA
            c7s0gauVgBicEQIhAKQP6ApCuMxsl7ZB9zd4d4rK4CL/Kq7+aHPM+Zc42o3NAiAV
            8bZ9UdYLXr4xuCJ1ktyr/8lCy/IJ6qEPYQyBLfhuVQ==
            -----END RSA PRIVATE KEY-----
          containsSecret: true
          match: -----BEGIN RSA PRIVATE KEY-----

    - id: rsa-private-key-encrypted
      metadata:
        name: RSA encrypted private keys should not be disclosed
      detection:
        matching:
          pattern: "\\b-----BEGIN RSA PRIVATE KEY-----\\b"
          context:
            matchEach:
              - patternAfter: "\\bProc-Type: 4,ENCRYPTED\\b"
              - patternAfter: "\\bDEK-Info:\\b"
              - patternAfter: "\\b-----END RSA PRIVATE KEY-----\\b"
      examples:
        - text: >
            -----BEGIN RSA PRIVATE KEY-----
            Proc-Type: 4,ENCRYPTED
            DEK-Info: AES-128-CBC,9F1821EB06762C94DFD5CBD8FEA32003

            cJXTJrwEB9sLrJrTiD2kuRJc0ZpMzPv+dlljYUCeG4a+LSwppsABDOAeQLIcrBg4
            RTCk+5hgAI2eN0E1yaaE8K1IwTxCnM2NqzYf1n6ksBdLwW1OTUiM0WHFMj94SLzV
            WYAOm+06RG0Phd46JPSgnr6XDnHJKcKzBOwB03dY4jBBbN9Tr/9XfOjzAoGU/dbk
            m5YoUPSWqujlevFRICOE2Lc3SmD2B5rJ+C44GvhkUDHXoFHGYEfYk1oCEWhltM+3
            7vRn6rzsiB3wUT4hty4o4kFcKTCzsSn1vs7St/vx98S80dkJ8+M+IQz62SQcwM+0
            /vqHMwdDSR6ZI7DlJk7CwKbBGdBzW1En46JcTs0h1nMXa/OTWjpZ9huWIxNF41Es
            yZPRR6TGpl7OvNQgW/8xsp1/m4EbWLz0cUV/0uq1PCDxCw8yqRRi+IzMS77TFSdo
            -----END RSA PRIVATE KEY-----
          containsSecret: true
          match: -----BEGIN RSA PRIVATE KEY-----

    - id: ec-private-key
      metadata:
        name: Elliptic curve private keys should not be disclosed
      detection:
        matching:
          pattern: "\\b-----BEGIN EC PRIVATE KEY-----\\b"
          context:
            patternAfter: "\\b-----END EC PRIVATE KEY-----\\b"
      examples:
        - text: >
            -----BEGIN EC PRIVATE KEY-----
            MF8CAQEEGEfVxjrMPigNhGP6DqH6DPeUZPbaoaCCXaAKBggqhkjOPQMBAaE0AzIA
            BCIxho34upZyXDi/AUy/TBisGeh4yKJN7pit9Z+nKs4QajVy97X8W9JdySlbWeRt
            2w==
            -----END EC PRIVATE KEY-----
          containsSecret: true
          match: -----BEGIN EC PRIVATE KEY-----
          
    - id: ec-private-key-encrypted
      metadata:
        name: Elliptic curve private keys should not be disclosed
      detection:
        matching:
          pattern: "\\b-----BEGIN EC PRIVATE KEY-----\\b"
          context:
            patternAfter: "\\bProc-Type: 4,ENCRYPTED\\b"
            patternAfter: "\\bDEK-Info:"
            patternAfter: "\\b-----END EC PRIVATE KEY-----\\b"
      examples:
        - text: >
            -----BEGIN EC PRIVATE KEY-----
            Proc-Type: 4,ENCRYPTED
            DEK-Info: AES-128-CBC,11ACAF38DB2E5318666628271D25419C

            NLs725frPmp2wmOGQC0i+HaHuRbVHMEVt679Vq1D4jzuWOh+tSeoGKbN4y1AQLNY
            LLidYhppiAerYPJ13yJvgynR9fAqq1VWYxXAmo0z/5U3YVCRWdz0tYbFSl2OwKXQ
            HPMwUHSdirPVe/KxvwsiZw==
            -----END EC PRIVATE KEY-----
          containsSecret: true
          match: -----BEGIN EC PRIVATE KEY-----