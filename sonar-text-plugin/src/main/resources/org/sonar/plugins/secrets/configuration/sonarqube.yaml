provider:
  metadata:
    name: SonarQube
    category: Code analysis
    references:
      - description: OWASP Top 10 2021 Category A7 - Identification and Authentication Failures
        link: https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
        type: Standards
      - description: Google Cloud - Creating and managing service account keys
        link: https://cloud.google.com/iam/docs/keys-create-delete
        type: Documentation
      - description: OWASP Top 10 2017 Category A3 - Sensitive Data Exposure
        link: https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure
        type: Standards
      - description: MITRE, CWE-798 - Use of Hard-coded Credentials
        link: https://cwe.mitre.org/data/definitions/798
        type: Standards
      - description: MITRE, CWE-259 - Use of Hard-coded Password
        link: https://cwe.mitre.org/data/definitions/259
        type: Standards
      - description: SANS Top 25 - Porous Defenses
        link: https://www.sans.org/top25-software-errors/#cat3
        type: Standards
    message: Make sure this SonarQube token gets revoked, changed, and removed from the code.
  detection:
    post:
        patternNot: "(EXAMPLE|PRIVATE_KEY)"
  rules:
    - id: Sxxxx
      metadata:
        name: SonarQube Tokens
      examples:
        - text: >
            sonar.login=sqp_sonarqube_token
            
            sonar.login=sqp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          containsSecret: false
        - text: >
            sonar.login=sqp_b4556a16fa2d28519d2451a911d2e073024010bc
          containsSecret: true
          match: "b4556a16fa2d28519d2451a911d2e073024010bc"
      detection:
        matching:
          pattern: "\\b(sq[apu]_[0-9a-f]{40})\\b"
    - id: Sxxxx
      metadata:
        name: SonarQube Tokens
      examples:
        - text: >
            sonar.login=sonarqube_token

            sonar.login=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          containsSecret: false
        - text: >
            sonar.login=9acf34ff1e738bcd6d5daf102a8cfcb8a158e44e
          containsSecret: true
          match: "9acf34ff1e738bcd6d5daf102a8cfcb8a158e44e"
      detection:
        matching:
          pattern: "(?is)\\bsonar\\b.{1,30}\\b([0-9a-f]{40})\\b"
