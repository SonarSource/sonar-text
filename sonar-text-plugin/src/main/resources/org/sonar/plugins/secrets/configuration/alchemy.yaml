provider:
  metadata:
    name: Alchemy Api Key
    category: Blockchain API
    message: Make sure this Alchemy API key gets revoked, changed, and removed from the code.

  rules:
    - rspecKey: S6719
      id: alchemy-api-keys
      metadata:
        name: Alchemy Api Keys
      examples:
        - text: |
            const NETWORKS = {
              '1': 'https://eth-mainnet.alchemyapi.io/v2/6wgSNoYMEzJ2s47Q593p9-9Xg5clkmAB',
            }
          containsSecret: true
          match: .alchemyapi.io/v2/6wgSNoYMEzJ2s47Q593p9-9Xg5clkmAB
        - text: |
            const NETWORKS = {
              '1': 'https://eth-mainnet.alchemyapi.io/v2/your-api-key',
            }
          containsSecret: false
        - text: |
            const NETWORKS = {
              '1': 'https://eth-mainnet.alchemyapi.io/v2/{API_KEY}',
            }
          containsSecret: false
      detection:
        matching:
          pattern: "(\\.alchemyapi\\.io/v2/[a-zA-Z0-9_-]{32})"
        post:
          patternNot:
            # https://eth-ropsten.alchemyapi.io/v2/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX and equivalents
            - "(\\w)\\1{7,}"
