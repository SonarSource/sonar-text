provider:
  metadata:
    name: Amazon MWS 
    category: Marketplace
    references:
      - description: OWASP Top 10 2021 Category A7 - Identification and Authentication Failures
        link: https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
        type: Standards
      - description: OWASP Top 10 2017 Category A3 - Sensitive Data Exposure
        link: https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure
        type: Standards
      - description: MITRE, CWE-798 - Use of Hard-coded Credentials
        link: https://cwe.mitre.org/data/definitions/798
        type: Standards
      - description: MITRE, CWE-259 - Use of Hard-coded Password
        link: https://cwe.mitre.org/data/definitions/259
        type: Standards
      - description: SANS Top 25 - Porous Defenses
        link: https://www.sans.org/top25-software-errors/#cat3
        type: Standards
  detection:
    post:
        patternNot: "EXAMPLE"
  rules:
    - id: S6292
      metadata:
        name: Amazon MWS authentication tokens
        message: Make sure this Amazon MWS token gets revoked, changed, and removed from the code.
      examples:
        - text: |
            export MWS_TOKEN=amzn.mws.4ea38b7b-f563-7709-4bae-12ba540c0ac5
          containsSecret: true
          match: amzn.mws.4ea38b7b-f563-7709-4bae-12ba540c0ac5
        - text: |
            export MWS_TOKEN=amz.mws.4ea38b7b-f563-7709-4bae-12ba540c0ac5",
            // extra characters before
            export MWS_TOKEN=blamzn.mws.4ea38b7b-f563-7709-4bae-12ba540c0ac5",
            // extra characters after
            export MWS_TOKEN=amzn.mws.4ea38b7b-f563-7709-4bae-12ba540c0ac52222222222222"
          containsSecret: false
      detection:
        matching:
          pattern: "\\b(amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\\b"
