provider:
  metadata:
    name: Stripe Webhook Secret
    category: Financial Service
    message: Make sure this Stripe Webhook secret gets revoked, changed, and removed from the code.

  rules:
    - rspecKey: S6718
      id: stripe-webhook-secret
      metadata:
        name: Stripe Webhook URL
      examples:
        - text: |
            endpoint_secret = 'whsec_AV1cfC0WFpnYPzHI1YUnlDS059g8I3Az';
            post '/webhook' do
              payload = request.body.read
              event = nil
          containsSecret: true
          match: whsec_AV1cfC0WFpnYPzHI1YUnlDS059g8I3Az
        - text: |
            endpoint_secret = 'whsec_...';
            post '/webhook' do
              payload = request.body.read
              event = nil
          containsSecret: false
      detection:
        matching:
          pattern: "(whsec_[0-9a-zA-Z]{32,64})"
    
