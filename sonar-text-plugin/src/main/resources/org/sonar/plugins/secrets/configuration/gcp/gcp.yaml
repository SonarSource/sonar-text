provider:
  metadata:
    name: Google
    category: Cloud provider
    references:
      - description: OWASP Top 10 2021 Category A7 - Identification and Authentication Failures
        link: https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
        type: Standards
      - description: Google Cloud - Using API keys
        link: https://cloud.google.com/docs/authentication/api-keys
        type: Documentation 
      - description: OWASP Top 10 2017 Category A3 - Sensitive Data Exposure
        link: https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure
        type: Standards
      - description: MITRE, CWE-798 - Use of Hard-coded Credentials
        link: https://cwe.mitre.org/data/definitions/798
        type: Standards
      - description: MITRE, CWE-259 - Use of Hard-coded Password
        link: https://cwe.mitre.org/data/definitions/259
        type: Standards
      - description: SANS Top 25 - Porous Defenses
        link: https://www.sans.org/top25-software-errors/#cat3
        type: Standards
    description: description.adoc
  modules:
    pre:
      include:
        - paths:
            - ".env"
            - ".*env*"
        - ext:
            - ".config"
        - content:
            - "(google|gcp)"
      reject:
        - paths: "*/tests?/*"
    post:
        - pattern-not: "EXAMPLE"
rules:
  - id: google-api-key
    metadata:
      name: Google API Keys should not be disclosed
      message: Make sure this Google API Key gets revoked, changed, and removed from the code.
      impact: google-api-key.adoc
    examples:
      - text: >
          android:value = "AIzaSyCis4NzxMw1aJyvUIrjGILjPkSdxrRfof4"
        match: AIzaSyCis4NzxMw1aJyvUIrjGILjPkSdxrRfof4
      - text: >
            "android:value=\"AIzaSyCis4NzxMw1aJyvUIrjGfof4\"",
            // extra characters before
            "android:value=\"KatitioAIzaSyCis4NzxMw1aJyvUIrjGILjPkSdxrRfof4\"",
            // extra characters after
            "android:value=\"AIzaSyCis4NzxMw1aJyvUIrjGfof4abc\""
        match: false
    modules:
      matching:
         - pattern: "\\b(AIza[0-9A-Za-z\\-_]{35})\\b"
