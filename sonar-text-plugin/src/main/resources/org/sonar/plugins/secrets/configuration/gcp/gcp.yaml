provider:
  metadata:
    name: Google
    category: Cloud provider
    references:
      - description: OWASP Top 10 2021 Category A7 - Identification and Authentication Failures
        link: https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
        type: Standards
      - description: Google Cloud - Creating and managing service account keys
        link: https://cloud.google.com/iam/docs/keys-create-delete
        type: Documentation
      - description: OWASP Top 10 2017 Category A3 - Sensitive Data Exposure
        link: https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure
        type: Standards
      - description: MITRE, CWE-798 - Use of Hard-coded Credentials
        link: https://cwe.mitre.org/data/definitions/798
        type: Standards
      - description: MITRE, CWE-259 - Use of Hard-coded Password
        link: https://cwe.mitre.org/data/definitions/259
        type: Standards
      - description: SANS Top 25 - Porous Defenses
        link: https://www.sans.org/top25-software-errors/#cat3
        type: Standards
    message: Make sure this GCP secret gets revoked, changed, and removed from the code.
  detection:
    post:
        patternNot: "EXAMPLE"
  rules:
    - id: google-service-account-key
      metadata:
        name: Google Service Account Keys should not be disclosed
      examples:
        - text: >
            {
              "type": "service_account",
              "project_id": "PROJECT_ID",
              "private_key_id": "KEY_ID",
              "private_key": "-----BEGIN PRIVATE KEY-----\\nPRIVATE_KEY \\n-----END PRIVATE KEY-----\\n",
              "client_email": "SERVICE_ACCOUNT_EMAIL",
              "client_id": "CLIENT_ID",
              "auth_uri": "https://accounts.google.com/o/oauth2/auth",
              "token_uri": "https://accounts.google.com/o/oauth2/token",
              "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
              "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/SERVICE_ACCOUNT_EMAIL "
            }
          containsSecret: false
        - text: >
              {
                "type": "service_account",
                "project_id": "sonar-text-gcp-service-account-fake-project",
                "private_key_id": "f560d248789641427bb72264839effb79098b86c",
                "private_key": "-----BEGIN PRIVATE KEY-----\\nMIJEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCoagGXuTHsB/r3\\n2W6raHa1Qrfj6pii5U2Ok53SxCyK3TxYc3Bfxq8orZeYC9LQ/I3tz7w4/BnT71AD\\nge42+ehWbxnLb9zjfpZJIHRPVfUi4AeWO4P/0TZIsZDXRmsfp4NW6xrCdTsypG+n\\niNN2NDMV5gCjovYh5QrTcvyoivWzoqltFrWb2OCGKtspTWcuf23OE04hrxqEoUMF\\nnEK221XYKc6jkhLBl10EWzuvUtBig0aaKjTCRJjTpiBBWfK+XermesnRbNV98aLQ\\nFj22RpU9vZ2dJivyDFtVQf5GXLrCL0gF7/uuPc2PrlnSx53mgEkU0ZaM+bnLpdUB\\nOsq22giHAgMBAAECggEAAPYsNqMHWL2AVRHLg0oKPf99ggMSLtIAUohwPjOZs1xR\\nnpz222fx1ZwD1va53+Tnfse7mHQ4MssOhJZQGFpvhN19uDt792ogFbzFF1F4IAVt\\nV2222W2MQTCPQMUzEfE3+QFkxAleZfV/Zx5lMrjK+AdbCz7Q1Mdq496/afEZVBah\\nUsV222y5lpFtj3Wr+xUVOzxC/wG192zX9vFYhcffTF9bWlak5J872thf8CpSEH8x\\njTXW23145U/1iSNBIO3qebF2yzOuBfLtsDfWaJKmNz3Wbry9DcQeB+m6p2ZxSbXK\\nHr189O/zW6415a1Xj6LFcu7uhEfqqdKRxnzFfi48vQKBgQDbtQIF4M/mk5R3nURn\\najJ8buK58746q86cxOZDM28qMDvPwm5ncqCb+NKuPE3hB8xvU/f9Dxl7o32cN4G2\\nBlE5v6124mHjnZtYaps7mKpkiGb+ZXNDfOg8qvBTDD0PIdorowzgDfHbMBjoOg/g\\ncVWS789456UyJ+lAbtgvLeJgwwKBgQDEO+qVf5un3kFrY9E7weaKgsTMeySjRmYw\\nx/RGq784519Ih4WRYhvDVbEjye2bPnAqhhkqVF1WAio9yWCC7ksT5lCH6kVIdL98\\n2498754632Jqk+zfKwzsLzcLNOoHRRbBvtx8G9dx81wwXhH4NKuWbqBv/rgOgDfy\\nPp/5784190KBgBEVehrK6F+diiXi7La94z8ZwDdCq2xNL7uw89a14Sb+qSf2jm8s\\n0q0000OrjMK6wILHnLjou6qJg/LpvgRRaWvoVAZb7LCuSK4PXBK+REGc+aU+bkAJ\\nLmX987654O9ASp6qBw5FB1Fr5APqv+FL7sN3GNDFcxr7T3/bHqRMhRXRAoGBAIvq\\nTLCb45632//CBAWfk0lfRAKoKs9f+qz9ZOadZPlA7apBNrMaSMFV8B+ccpYmRsOL\\nKZ787N/aW1QCqZWxYkamCPVfzFaFJ6NWxz/YfnMP+K8VGedlQqmEYLLU36ifUkKC\\nW6MCFvNgmXLDH/zhURbJegtgisuMEFfg3w+IESVhAoGAcgtd5kgnc9fgf/8g6P+m\\nVGVW7mcGvN1RoRpdTQbX7oyPAMknofWbY5cmLnLu04n7PmhXpQ1vMractTrZy+g5\\nfP1i8SWHsRMIicSuVFcRoYMA+A1eNSmdrujdBNWgedfuSyHbPnNY7s8BBUIoBN7I\\n8gJG5DUUKAZfZDB2c/n7Yu0=\\n-----END PRIVATE KEY-----\\n",
                "client_email": "gcp-service-account-key@fake-sonar-project.iam.gserviceaccount.com",
                "client_id": "234567841521909194926",
                "auth_uri": "https://accounts.google.com/o/oauth2/auth",
                "token_uri": "https://oauth2.googleapis.com/token",
                "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
                "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/gcp-service-account-key%40fake-sonar-project.iam.gserviceaccount.com",
                "universe_domain": "googleapis.com"
              }
          containsSecret: true
          match: "\\nMIJEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCoagGXuTHsB/r3\\n2W6raHa1Qrfj6pii5U2Ok53SxCyK3TxYc3Bfxq8orZeYC9LQ/I3tz7w4/BnT71AD\\nge42+ehWbxnLb9zjfpZJIHRPVfUi4AeWO4P/0TZIsZDXRmsfp4NW6xrCdTsypG+n\\niNN2NDMV5gCjovYh5QrTcvyoivWzoqltFrWb2OCGKtspTWcuf23OE04hrxqEoUMF\\nnEK221XYKc6jkhLBl10EWzuvUtBig0aaKjTCRJjTpiBBWfK+XermesnRbNV98aLQ\\nFj22RpU9vZ2dJivyDFtVQf5GXLrCL0gF7/uuPc2PrlnSx53mgEkU0ZaM+bnLpdUB\\nOsq22giHAgMBAAECggEAAPYsNqMHWL2AVRHLg0oKPf99ggMSLtIAUohwPjOZs1xR\\nnpz222fx1ZwD1va53+Tnfse7mHQ4MssOhJZQGFpvhN19uDt792ogFbzFF1F4IAVt\\nV2222W2MQTCPQMUzEfE3+QFkxAleZfV/Zx5lMrjK+AdbCz7Q1Mdq496/afEZVBah\\nUsV222y5lpFtj3Wr+xUVOzxC/wG192zX9vFYhcffTF9bWlak5J872thf8CpSEH8x\\njTXW23145U/1iSNBIO3qebF2yzOuBfLtsDfWaJKmNz3Wbry9DcQeB+m6p2ZxSbXK\\nHr189O/zW6415a1Xj6LFcu7uhEfqqdKRxnzFfi48vQKBgQDbtQIF4M/mk5R3nURn\\najJ8buK58746q86cxOZDM28qMDvPwm5ncqCb+NKuPE3hB8xvU/f9Dxl7o32cN4G2\\nBlE5v6124mHjnZtYaps7mKpkiGb+ZXNDfOg8qvBTDD0PIdorowzgDfHbMBjoOg/g\\ncVWS789456UyJ+lAbtgvLeJgwwKBgQDEO+qVf5un3kFrY9E7weaKgsTMeySjRmYw\\nx/RGq784519Ih4WRYhvDVbEjye2bPnAqhhkqVF1WAio9yWCC7ksT5lCH6kVIdL98\\n2498754632Jqk+zfKwzsLzcLNOoHRRbBvtx8G9dx81wwXhH4NKuWbqBv/rgOgDfy\\nPp/5784190KBgBEVehrK6F+diiXi7La94z8ZwDdCq2xNL7uw89a14Sb+qSf2jm8s\\n0q0000OrjMK6wILHnLjou6qJg/LpvgRRaWvoVAZb7LCuSK4PXBK+REGc+aU+bkAJ\\nLmX987654O9ASp6qBw5FB1Fr5APqv+FL7sN3GNDFcxr7T3/bHqRMhRXRAoGBAIvq\\nTLCb45632//CBAWfk0lfRAKoKs9f+qz9ZOadZPlA7apBNrMaSMFV8B+ccpYmRsOL\\nKZ787N/aW1QCqZWxYkamCPVfzFaFJ6NWxz/YfnMP+K8VGedlQqmEYLLU36ifUkKC\\nW6MCFvNgmXLDH/zhURbJegtgisuMEFfg3w+IESVhAoGAcgtd5kgnc9fgf/8g6P+m\\nVGVW7mcGvN1RoRpdTQbX7oyPAMknofWbY5cmLnLu04n7PmhXpQ1vMractTrZy+g5\\nfP1i8SWHsRMIicSuVFcRoYMA+A1eNSmdrujdBNWgedfuSyHbPnNY7s8BBUIoBN7I\\n8gJG5DUUKAZfZDB2c/n7Yu0=\\n"
      detection:
        matching:
          pattern: "\"private_key\"\\s*:\\s*\"(-----BEGIN PRIVATE KEY-----\\\\n[a-z-A-Z0-9+/=]{64}\\\\n[a-z-A-Z0-9+/=\\\\]+-----END PRIVATE KEY-----(:?\\\\n)?)\""
        post:
          patternNot: PRIVATE_KEY
