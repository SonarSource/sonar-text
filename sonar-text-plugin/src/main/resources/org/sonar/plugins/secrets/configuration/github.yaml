provider:
  metadata:
    name: GitHub
    category: Code hosting
    message: Make sure this Github token gets revoked, changed, and removed from the code.

  rules:
    - id: github-v2-tokens
      metadata:
        name: Github tokens should not be disclosed
      detection:
        matching:
          pattern: "gh[puso]_(?<rand>[a-zA-Z0-9]{36})"
        post:
          statisticalFilter:
            threshold: 4 # Based on significant sampling, lowest observed entropy is 4.1
            inputString: $rand # Not sure this is implemented yet. Threshold should be OK with the full candidate
      examples:
        - text: >
            gh_token=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
          containsSecret: true
          match: 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
