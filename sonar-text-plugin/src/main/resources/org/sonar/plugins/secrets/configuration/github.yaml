provider:
  metadata:
    name: GitHub
    category: Code hosting
    message: Make sure this Github token gets revoked, changed, and removed from the code.

  rules:
    - id: github-v2-tokens
      metadata:
        name: Github tokens should not be disclosed
      detection:
        matching:
          pattern: "\\bgh[puso]_(?<rand>[a-zA-Z0-9]{36})\\b"
        post:
          statisticalFilter:
            threshold: 4 # Based on significant sampling, lowest observed entropy is 4.1
            inputString: $rand # Not sure this is implemented yet. Threshold should be OK with the full candidate
      examples:
        - text: >
            gh_token=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
          containsSecret: true
          match: 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
    
    - id: github-fine-grained-tokens
      metadata:
        name: Github tokens should not be disclosed
      detection:
        matching:
          pattern: "\\bgithub_pat_(?<rand>[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})\\b"
        post:
          statisticalFilter:
            threshold: 4.8 # Based on significant sampling, 4.9 < entropy 5.6
            inputString: $rand # Not sure this is implemented yet. Threshold should be OK with the full candidate
      examples:
        - text: >
            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
          containsSecret: true
          match: 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
        - text: >
            TOKEN=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
          containsSecret: true
          match: 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
