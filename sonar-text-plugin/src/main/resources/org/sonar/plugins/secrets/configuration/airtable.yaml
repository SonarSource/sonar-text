provider:
  metadata:
    name: Airtable API key
    category: Cloud Collaboration
    message: Make sure this Airtable API key gets revoked, changed, and removed from the code.

  rules:
    - id: airtable-api-key
      rspecKey: S6733
      metadata:
        name: Airtable API keys should not be disclosed
      detection:
        matching:
          pattern: "\\b(key[a-zA-Z0-9]{14})\\b"
          context:
            patternAround: "(?i)\\bairtable"
        post:
          #patternNot:
          #  - "(?i)(s|ex)ample"
          #  # keyXXXXXXXXXXXXXX and key00000000000000
          #  - "(\\w)\\1{5,}"
          #  # keyAPI12345678910
          #  - "12345678"
          patternNot: "(?i)\
            example|\
            (\\w)\\1{5,}|\
            12345678"
      examples:
        - text: |
            export const proxy = 'https://api.airtable.com/v0/appywrdcoWllMrj0o/Plugins';
            export const airtable_key = 'keyAHLsjg6TP67TCy';
          containsSecret: true
          match: keyAHLsjg6TP67TCy
        - text: |
            # Download translations.
            ARG AIRTABLE_API_KEY=key6yLyCekATg67Ts
            ARG FAIL_ON_MISSING_TRANSLATIONS
          containsSecret: true
          match: key6yLyCekATg67Ts
        - text: |
            import vdplus.api.airtable
            options.airtable_key = 'keyexampleexample'
          containsSecret: false
        - text: |
            import vdplus.api.airtable
            options.airtable_key = 'keyXXXXXXXXXXXXXX'
          containsSecret: false
        - text: |
            import vdplus.api.airtable
            options.airtable_key = 'key00000000000000'
          containsSecret: false
        - text: |
            '/home/.config/.airtableblocksrc.json': Buffer.from(
                '{"airtableApiKey":"keyAPI12345678910"}',
            ),
          containsSecret: false
