provider:
  metadata:
    name: Airtable
    category: Spreadsheets as a service
    message: Make sure this Airtable API key gets revoked, changed, and removed from the code.
  detection:
    pre:
      include:
        content:
          - airtable
          - table

  rules:
    - id: airtable-key
      rspecKey: S6733
      metadata:
        name: Airtable API Keys should not be disclosed
      detection:
        matching:
          # Type 2 secret: There's a key prefix, but too vague
          pattern: "(?i)\\bkey[\\w]{14}\\b"
          context:
            patternAround: "(?i)(airtable|base|table)"
        post:
          patternNot: "(?i)\
            (\\w)\\1{4,}|\
            example|\
            12345678"
      examples:
        - text: |
            const axios = require('axios');

            const apiKey = 'keyWoQ4ADxA9EQrOk';
            const baseId = 'YOUR_BASE_ID';
            const tableName = 'YOUR_TABLE_NAME';

            // Fetch records from Airtable
            axios.get(`https://api.airtable.com/v0/${baseId}/${tableName}`, {
              headers: {
                Authorization: `Bearer ${apiKey}`,
              },
            })
              .then(response => {
                const records = response.data.records;
                console.log(records);
              })
              .catch(error => {
                console.error(error);
              });
          containsSecret: true
          match: keyWoQ4ADxA9EQrOk

        - text: |
            export function KeyboardShortcuts ()
          containsSecret: false
        - text: |
            public class AirtableExample {
                public static void main(String[] args) {
                    String apiKey = "keyyyyyyyyyyyyyyy";
                    String baseId = "YOUR_BASE_ID";
                    String tableName = "YOUR_TABLE_NAME";

                    try {
                        // Create the URL for the Airtable API request
                        URL url = new URL("https://api.airtable.com/v0/" + baseId + "/" + tableName);
          containsSecret: false

