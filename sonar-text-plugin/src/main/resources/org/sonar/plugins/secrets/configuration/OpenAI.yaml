provider:
  metadata:
    name: OpenAI
    category: Artificial Intelligence
    message: Make sure this OpenAI API key gets revoked, changed, and removed from the code.
  detection:
    pre:
      include:
        content:
          - "openai"
  rules:
    - rspecKey: S7013
      id: openai
      metadata:
        name: OpenAI API keys should not be disclosed
      detection:
        matching:
          pattern: "\\b(sk-(?:[a-zA-Z0-9-]+-)?([a-zA-Z0-9]{48,250}))\\b"
          context:
            patternAround:
              pattern: "(?i)openai"
              maxLineDistance: 2
        post:
          statisticalFilter:
            threshold: 3.9
          patternNot:
            - "(?<char>[a-zA-Z0-9])\\k<char>{4,}[^-]*$"
      examples:
        - text: |
            props.set("openai-api-key", "sk-proj-HjexYIWYuDkZotTHif0eT3BlbkFJy9hISv8XIq6QmG1DMUJ9")
          containsSecret: true
          match: "sk-proj-HjexYIWYuDkZotTHif0eT3BlbkFJy9hISv8XIq6QmG1DMUJ9"
        - text: |
            const openai = new OpenAI({
              apiKey: "sk-foobar-pTOaX0lK5EzxpuDfnhqHS1LrvqJAUo2xNJPxrJR6WYQRXxya",
            });
          containsSecret: true
          match: sk-foobar-pTOaX0lK5EzxpuDfnhqHS1LrvqJAUo2xNJPxrJR6WYQRXxya
        - text: |
            const openai = new OpenAI({
              apiKey: "sk-proj-111111111111111111111111111111111111111111111111",
            });
          containsSecret: false
        - text: |
            OPENAI_API_KEY = SecretStr("sk-EUk0Tal8cIkmG4vJF904F57a9eE241A8Ae72666fAxxxxxxx")
          containsSecret: false
        - text: |
            // const configuration = new Configuration({
            //     apiKey: Config.OPENAI_API_KEY || "sk-TyAL0vjvW7gtLhwolRrNE2PajjML6zvx9BqborNnl0RJjkQv",
            // });
          containsSecret: true
          match: sk-TyAL0vjvW7gtLhwolRrNE2PajjML6zvx9BqborNnl0RJjkQv
        - text: |
            OPENAI_API_KEY=sk-svcacct-T4fG7hJkL9nQpXvZbC3rA1sD5yU8iO0wE2fH6jKlR9vW3bZc6jKlMnPqA7gJkL9nA1bC2dE3fG4hI5jK6lM7nO8pQ9rS0tU1vW2xY3zX7yZ8aB9cD0eF1gH2iJ3kL4mN5oP6qR7sT8uV9w
          containsSecret: true
          match: sk-svcacct-T4fG7hJkL9nQpXvZbC3rA1sD5yU8iO0wE2fH6jKlR9vW3bZc6jKlMnPqA7gJkL9nA1bC2dE3fG4hI5jK6lM7nO8pQ9rS0tU1vW2xY3zX7yZ8aB9cD0eF1gH2iJ3kL4mN5oP6qR7sT8uV9w
