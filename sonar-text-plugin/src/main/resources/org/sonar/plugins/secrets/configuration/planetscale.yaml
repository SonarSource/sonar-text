provider:  
  metadata:
      name: Planetscale
      category: Data storage
      message: Make sure this Planetscale database password gets changed and removed from the code.
  detection:
    post:
      # Avoid matching values found on SourceGraph that look like dummy passwords or insertions like:
      # - pscale_pw_sample
      # - pscale_pw_example
      # - pscale_pw_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
      # - pscale_pw_0000000000000000000000000000000000000000000
      patternNot: 
        - "(?i)\
          sample|\
          example|\
          (\\w)\\1{3,}"

  rules:
    - id: planetscale-password
      rspecKey: S6722
      metadata:
        name: Planetscale database passwords should not be disclosed
      detection:
        matching:
          pattern: "(\\bpscale_pw_[a-zA-Z0-9\\-_\\.]{43})"
      examples:
        - text: |
            spring.datasource.username=user
            spring.datasource.password=pscale_pw_CoNLTwSMJwvKspy89_2JdSoxmGWaElypgmlzel5KolA
          containsSecret: true
          match: pscale_pw_CoNLTwSMJwvKspy89_2JdSoxmGWaElypgmlzel5KolA
        - text: |
            "user": null,
            "password": "pscale_pw_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
          containsSecret: false
        - text: |
            "user": null,
            "password": "pscale_pw_0000000000000000000000000000000000000000000",
          containsSecret: false
