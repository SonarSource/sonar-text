provider:
  metadata:
    name: Facebook
    category: Social media
    message: Make sure this Facebook key gets revoked, changed, and removed from the code.

  rules:
    - id: facebook-app-key
      metadata:
        name: Facebook app keys should not be disclosed
      detection:
        pre:
          include:
            content:
              - "facebook"
        matching:
          pattern: "\\b[a-f0-9]{32}\\b"
        post:
          statisticalFilter:
            threshold: 3.6 # Based on significant sampling, 3.7 < entropy < 4.4
            inputString: $rand
      examples:
        - text: >
            {
              "type": "core/v1/state",
              "properties": {
                "key": "token",
                "initialValue": "6f1bbe24b9mshcbb5030202794a4p18f7d0jsndd55ab0f981d"
              }
            }
          containsSecret: true
          match: 6f1bbe24b9mshcbb5030202794a4p18f7d0jsndd55ab0f981d
