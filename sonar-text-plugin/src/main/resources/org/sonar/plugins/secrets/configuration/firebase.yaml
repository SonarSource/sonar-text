provider:
  metadata:
    name: Firebase
    category: Development
    message: Make sure this Firebase key gets revoked, changed, and removed from the code.
# detection:
#   pre:
#     include:
#       content:
#         - "(?i)(firebase|google|messaging|fcm)"
  rules:
    - id: legacy-fcm-api-key
      rspecKey: S6710
      metadata:
        name: Legacy Firebase Cloud Messaging API Key
      detection:
        matching:
          pattern: "(?i)\\b([A-Za-z0-9\\-_]{11}:apa91b[A-Za-z0-9\\-_+]{134})\\b"
      examples:
        - text: |
            function mobileDebugInit(){
                registerDevice("cJgpGj49rfM:APA91bFiH7g1Ch79DQW1_Z_k01eCeYOx2Y76yWUWBfgQ-48UI-bZDkc6YiWsmpBAuA_2g9zwAlHgQMTJ1LxGInjvQDE1wc5-vDDI0AvxAk4spA3EFsh1DXL5SbY3tSVJ64A6pvZvpix_");
            }
          containsSecret: true
          match: "cJgpGj49rfM:APA91bFiH7g1Ch79DQW1_Z_k01eCeYOx2Y76yWUWBfgQ-48UI-bZDkc6YiWsmpBAuA_2g9zwAlHgQMTJ1LxGInjvQDE1wc5-vDDI0AvxAk4spA3EFsh1DXL5SbY3tSVJ64A6pvZvpix_"
        - text: |
            endpoint = {
              'https://android.googleapis.com/gcm/send/cfUDlZL9YBQ:APA91bExYfB9ymMLJrR6rrDDSdGR614iMWXDHYVQpE2ETwMjJrghcWDKrEHwnay5FTCI57IDZuDfSMyPKszTRwik6_LI4Be-wGb3O-ZlTLYABeRAyhNqQMgC-tDh1zL5xELer2dEZevZ',
              expirationTime: null,
            }
          containsSecret: true
          match: "cfUDlZL9YBQ:APA91bExYfB9ymMLJrR6rrDDSdGR614iMWXDHYVQpE2ETwMjJrghcWDKrEHwnay5FTCI57IDZuDfSMyPKszTRwik6_LI4Be-wGb3O-ZlTLYABeRAyhNqQMgC-tDh1zL5xELer2dEZevZ"
        - text: |
            var pushSubscription = {
                "endpoint": "https://fcm.googleapis.com/fcm/send/cleVkhW1g-Q:APA91bEHLlxsKpNpTL9FbLyZQVfbv8_67KeyA7JFm1r983BiLFXVxOeRoHr7PxftcmTjgEJgA6oS7EiAfNcdVblRSPsyucfvc9l93n-Z9BvJRRaJZhKTNFrZdJ5RFL9jnkBEmtsNnOTL",
                "keys": {}
          containsSecret: true
          match: "cleVkhW1g-Q:APA91bEHLlxsKpNpTL9FbLyZQVfbv8_67KeyA7JFm1r983BiLFXVxOeRoHr7PxftcmTjgEJgA6oS7EiAfNcdVblRSPsyucfvc9l93n-Z9BvJRRaJZhKTNFrZdJ5RFL9jnkBEmtsNnOTL"
        - text: |
            var pushSubscription = {
                "endpoint": "https://fcm.googleapis.com/fcm/send/cleVkhW1g-Q:APA91b-DUMMY",
                "keys": {}
          containsSecret: false
